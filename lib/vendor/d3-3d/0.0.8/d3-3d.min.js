!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.d3=t.d3||{})}(this,function(t){"use strict";function e(t){var e=t.slice(0),r=0;e.push(e[0]);for(var n=0;n<=t.length-1;n++){var o=n+1,c=e[n].rotated,d=e[o].rotated;r+=(d.x-c.x)*(d.y+c.y)}return r>0}function r(t){for(var e=0,r=0,n=0,o=t.length,c=o-1;c>=0;c--)e+=t[c].rotated.x,r+=t[c].rotated.y,n+=t[c].rotated.z;return{x:e/o,y:r/o,z:n/o}}function n(t,e){var r=e.rotateCenter;t.x-=r[0],t.y-=r[1],t.z-=r[2];var n=o(c(d(t,e.z),e.y),e.x);return n.x+=r[0],n.y+=r[1],n.z+=r[2],n}function o(t,e){var r=Math.sin(e),n=Math.cos(e);return{x:t.x,y:t.y*n-t.z*r,z:t.y*r+t.z*n}}function c(t,e){var r=Math.sin(e),n=Math.cos(e);return{x:t.z*r+t.x*n,y:t.y,z:t.z*n-t.x*r}}function d(t,e){var r=Math.sin(e),n=Math.cos(e);return{x:t.x*n-t.y*r,y:t.y*r+t.y*n,z:t.z}}function a(t,e,r,o){for(var c=t.length-1;c>=0;c--){var d=t[c];d.rotated=n({x:r.x(d),y:r.y(d),z:r.z(d)},o),d.centroid=d.rotated,d.projected=e.project(d.rotated,e)}return t}function i(t,n,o,c){for(var d=t.length-1;d>=0;d--){var i=t[d],u=a([i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]],n,o,c),f=u[0],y=u[1],x=u[2],p=u[3],z=u[4],j=u[5],h=u[6],l=u[7],v=[f,y,x,p],g=[l,h,j,z],s=[z,j,y,f],I=[p,x,h,l],L=[z,f,p,l],N=[y,j,h,x];v.centroid=r(v),g.centroid=r(g),s.centroid=r(s),I.centroid=r(I),L.centroid=r(L),N.centroid=r(N),v.ccw=e(v),g.ccw=e(g),s.ccw=e(s),I.ccw=e(I),L.ccw=e(L),N.ccw=e(N),v.face="front",g.face="back",s.face="left",I.face="right",L.face="top",N.face="bottom";var w=[v,g,s,I,L,N];i.faces=w,i.centroid={x:(s.centroid.x+I.centroid.x)/2,y:(L.centroid.y+N.centroid.y)/2,z:v.centroid.z+g.centroid.z/2}}return t}function u(t,n,o,c){for(var d=a(t,n,o,c),i=0,u=[],f=n.row,y=d.length/f-1;y>0;y--)for(var x=f-1;x>0;x--){var p=x+y*f,z=p-1,j=z-f+1,h=j-1,l=[d[p],d[j],d[h],d[z]];l.plane="plane_"+i++,l.ccw=e(l),l.centroid=r(l),u.push(l)}return u}function f(t,e,o,c){for(var d=t.length-1;d>=0;d--){for(var a=t[d],i=a.length/2,u=parseInt(i),f=a.length-1;f>=0;f--){var y=a[f];y.rotated=n({x:o.x(y),y:o.y(y),z:o.z(y)},c),y.projected=e.project(y.rotated,e)}a.centroid=u===i?r([a[i-1],a[i]]):{x:a[u].rotated.x,y:a[u].rotated.y,z:a[u].rotated.z}}return t}function y(t,e,o,c){for(var d=t.length-1;d>=0;d--){var a=t[d],i=a[0],u=a[1];i.rotated=n({x:o.x(i),y:o.y(i),z:o.z(i)},c),u.rotated=n({x:o.x(u),y:o.y(u),z:o.z(u)},c),i.projected=e.project(i.rotated,e),u.projected=e.project(u.rotated,e),a.centroid=r(a)}return t}function x(t,o,c,d){for(var a=t.length-1;a>=0;a--){var i=t[a],u=i[0],f=i[1],y=i[2],x=i[3];u.rotated=n({x:c.x(u),y:c.y(u),z:c.z(u)},d),f.rotated=n({x:c.x(f),y:c.y(f),z:c.z(f)},d),y.rotated=n({x:c.x(y),y:c.y(y),z:c.z(y)},d),x.rotated=n({x:c.x(x),y:c.y(x),z:c.z(x)},d),u.projected=o.project(u.rotated,o),f.projected=o.project(f.rotated,o),y.projected=o.project(y.rotated,o),x.projected=o.project(x.rotated,o),i.ccw=e(i),i.centroid=r(i)}return t}function p(t,o,c,d){for(var a=t.length-1;a>=0;a--){var i=t[a],u=i[0],f=i[1],y=i[2];u.rotated=n({x:c.x(u),y:c.y(u),z:c.z(u)},d),f.rotated=n({x:c.x(f),y:c.y(f),z:c.z(f)},d),y.rotated=n({x:c.x(y),y:c.y(y),z:c.z(y)},d),u.projected=o.project(u.rotated,o),f.projected=o.project(f.rotated,o),y.projected=o.project(y.rotated,o),i.ccw=e(i),i.centroid=r(i)}return t}function z(t){for(var e=t[t.length-1],r="M"+e.projected.x+","+e.projected.y,n=t.length-2;n>=0;n--){var o=t[n].projected;r+="L"+o.x+","+o.y}return r}function j(t){return"M"+t[0].projected.x+","+t[0].projected.y+"L"+t[1].projected.x+","+t[1].projected.y+"L"+t[2].projected.x+","+t[2].projected.y+"L"+t[3].projected.x+","+t[3].projected.y+"Z"}function h(t){return"M"+t[0].projected.x+","+t[0].projected.y+"L"+t[1].projected.x+","+t[1].projected.y+"L"+t[2].projected.x+","+t[2].projected.y+"Z"}function l(t,e){return{x:e.origin[0]+e.scale*t.x,y:e.origin[1]+e.scale*t.y}}function v(t){return t[0]}function g(t){return t[1]}function s(t){return t[2]}t._3d=function(){function t(t){return P[M](t,{scale:r,origin:e,project:n,row:E},{x:L,y:N,z:w},{x:o,y:c,z:d,rotateCenter:I})}var e=[0,0],r=1,n=l,o=0,c=0,d=0,I=[0,0,0],L=v,N=g,w=s,E=void 0,M="POINT",P={CUBE:i,GRID:u,LINE:y,LINE_STRIP:f,PLANE:x,POINT:a,SURFACE:u,TRIANGLE:p},R={CUBE:j,GRID:j,LINE_STRIP:z,PLANE:j,SURFACE:j,TRIANGLE:h};return t.origin=function(r){return arguments.length?(e=r,t):e},t.scale=function(e){return arguments.length?(r=e,t):r},t.rotateX=function(e){return arguments.length?(o=e,t):o},t.rotateY=function(e){return arguments.length?(c=e,t):c},t.rotateZ=function(e){return arguments.length?(d=e,t):d},t.shape=function(e,r){return arguments.length?(M=e,E=r,t):M},t.rotateCenter=function(e){return arguments.length?(I=e,t):I},t.x=function(e){return arguments.length?(L="function"==typeof e?e:+e,t):L},t.y=function(e){return arguments.length?(N="function"==typeof e?e:+e,t):N},t.z=function(e){return arguments.length?(w="function"==typeof e?e:+e,t):w},t.sort=function(t,e){var r=t.centroid.z,n=e.centroid.z;return r<n?-1:r>n?1:r>=n?0:NaN},t.draw=function(t){if("POINT"!==M&&"LINE"!==M)return R[M](t)},t},Object.defineProperty(t,"__esModule",{value:!0})});