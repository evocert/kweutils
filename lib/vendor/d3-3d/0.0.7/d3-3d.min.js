!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.d3=t.d3||{})}(this,function(t){"use strict";function e(t){var e=t.slice(0),r=0;e.push(e[0]);for(var o=0;o<=t.length-1;o++){var n=o+1,c=e[o].rotated,d=e[n].rotated;r+=(d.x-c.x)*(d.y+c.y)}return r>0}function r(t){for(var e=0,r=0,o=0,n=t.length,c=n-1;c>=0;c--)e+=t[c].rotated.x,r+=t[c].rotated.y,o+=t[c].rotated.z;return{x:e/n,y:r/n,z:o/n}}function o(t,e){var r=e.rotateCenter;t.x-=r[0],t.y-=r[1],t.z-=r[2];var o=n(c(d(t,e.z),e.y),e.x);return o.x+=r[0],o.y+=r[1],o.z+=r[2],o}function n(t,e){var r=Math.sin(e),o=Math.cos(e);return{x:t.x,y:t.y*o-t.z*r,z:t.y*r+t.z*o}}function c(t,e){var r=Math.sin(e),o=Math.cos(e);return{x:t.z*r+t.x*o,y:t.y,z:t.z*o-t.x*r}}function d(t,e){var r=Math.sin(e),o=Math.cos(e);return{x:t.x*o-t.y*r,y:t.y*r+t.y*o,z:t.z}}function a(t,e,r,n){for(var c=t.length-1;c>=0;c--){var d=t[c];d.rotated=o({x:r.x(d),y:r.y(d),z:r.z(d)},n),d.centroid=d.rotated,d.projected=e.project(d.rotated,e)}return t}function i(t,o,n,c){for(var d=t.length-1;d>=0;d--){var i=t[d],u=a([i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]],o,n,c),f=u[0],y=u[1],p=u[2],x=u[3],j=u[4],z=u[5],h=u[6],l=u[7],v=[f,y,p,x],g=[l,h,z,j],s=[j,z,y,f],L=[x,p,h,l],N=[j,f,x,l],I=[y,z,h,p];v.centroid=r(v),g.centroid=r(g),s.centroid=r(s),L.centroid=r(L),N.centroid=r(N),I.centroid=r(I),v.ccw=e(v),g.ccw=e(g),s.ccw=e(s),L.ccw=e(L),N.ccw=e(N),I.ccw=e(I),v.face="front",g.face="back",s.face="left",L.face="right",N.face="top",I.face="bottom";var w=[v,g,s,L,N,I];i.faces=w,i.centroid={x:(s.centroid.x+L.centroid.x)/2,y:(N.centroid.y+I.centroid.y)/2,z:v.centroid.z+g.centroid.z/2}}return t}function u(t,o,n,c){for(var d=a(t,o,n,c),i=0,u=[],f=o.row,y=d.length/f,p=y-1;p>0;p--)for(var x=f-1;x>0;x--){var j=x+p*y,z=j-1,h=z-y+1,l=h-1,v=[d[j],d[h],d[l],d[z]];v.plane="plane_"+i++,v.ccw=e(v),v.centroid=r(v),u.push(v)}return u}function f(t,e,n,c){for(var d=t.length-1;d>=0;d--){for(var a=t[d],i=a.length/2,u=parseInt(i),f=a.length-1;f>=0;f--){var y=a[f];y.rotated=o({x:n.x(y),y:n.y(y),z:n.z(y)},c),y.projected=e.project(y.rotated,e)}a.centroid=u===i?r([a[i-1],a[i]]):{x:a[u].rotated.x,y:a[u].rotated.y,z:a[u].rotated.z}}return t}function y(t,e,n,c){for(var d=t.length-1;d>=0;d--){var a=t[d],i=a[0],u=a[1];i.rotated=o({x:n.x(i),y:n.y(i),z:n.z(i)},c),u.rotated=o({x:n.x(u),y:n.y(u),z:n.z(u)},c),i.projected=e.project(i.rotated,e),u.projected=e.project(u.rotated,e),a.centroid=r(a)}return t}function p(t,n,c,d){for(var a=t.length-1;a>=0;a--){var i=t[a],u=i[0],f=i[1],y=i[2],p=i[3];u.rotated=o({x:c.x(u),y:c.y(u),z:c.z(u)},d),f.rotated=o({x:c.x(f),y:c.y(f),z:c.z(f)},d),y.rotated=o({x:c.x(y),y:c.y(y),z:c.z(y)},d),p.rotated=o({x:c.x(p),y:c.y(p),z:c.z(p)},d),u.projected=n.project(u.rotated,n),f.projected=n.project(f.rotated,n),y.projected=n.project(y.rotated,n),p.projected=n.project(p.rotated,n),i.ccw=e(i),i.centroid=r(i)}return t}function x(t,n,c,d){for(var a=t.length-1;a>=0;a--){for(var i=t[a],u=i.length-1;u>=0;u--){var f=i[u];f.rotated=o({x:c.x(f),y:c.y(f),z:c.z(f)},d),f.projected=n.project(f.rotated,n)}i.ccw=e(i),i.centroid=r(i)}return t}function j(t,n,c,d){for(var a=t.length-1;a>=0;a--){var i=t[a],u=i[0],f=i[1],y=i[2];u.rotated=o({x:c.x(u),y:c.y(u),z:c.z(u)},d),f.rotated=o({x:c.x(f),y:c.y(f),z:c.z(f)},d),y.rotated=o({x:c.x(y),y:c.y(y),z:c.z(y)},d),u.projected=n.project(u.rotated,n),f.projected=n.project(f.rotated,n),y.projected=n.project(y.rotated,n),i.ccw=e(i),i.centroid=r(i)}return t}function z(t){for(var e=t[t.length-1],r="M"+e.projected.x+","+e.projected.y,o=t.length-2;o>=0;o--){var n=t[o].projected;r+="L"+n.x+","+n.y}return r}function h(t){return"M"+t[0].projected.x+","+t[0].projected.y+"L"+t[1].projected.x+","+t[1].projected.y+"L"+t[2].projected.x+","+t[2].projected.y+"L"+t[3].projected.x+","+t[3].projected.y+"Z"}function l(t){for(var e=t[t.length-1],r="M"+e.projected.x+","+e.projected.y,o=t.length-2;o>=0;o--){var n=t[o].projected;r+="L"+n.x+","+n.y}return r+="Z"}function v(t){return"M"+t[0].projected.x+","+t[0].projected.y+"L"+t[1].projected.x+","+t[1].projected.y+"L"+t[2].projected.x+","+t[2].projected.y+"Z"}function g(t,e){return{x:e.origin[0]+e.scale*t.x,y:e.origin[1]+e.scale*t.y}}function s(t){return t[0]}function L(t){return t[1]}function N(t){return t[2]}t._3d=function(){function t(t){return R[O](t,{scale:r,origin:e,project:o,row:P},{x:w,y:E,z:M},{x:n,y:c,z:d,rotateCenter:I})}var e=[0,0],r=1,o=g,n=0,c=0,d=0,I=[0,0,0],w=s,E=L,M=N,P=void 0,O="POINT",R={CUBE:i,GRID:u,LINE:y,LINE_STRIP:f,PLANE:p,POINT:a,POLYGON:x,SURFACE:u,TRIANGLE:j},C={CUBE:h,GRID:h,LINE_STRIP:z,PLANE:h,POLYGON:l,SURFACE:h,TRIANGLE:v};return t.origin=function(r){return arguments.length?(e=r,t):e},t.scale=function(e){return arguments.length?(r=e,t):r},t.rotateX=function(e){return arguments.length?(n=e,t):n},t.rotateY=function(e){return arguments.length?(c=e,t):c},t.rotateZ=function(e){return arguments.length?(d=e,t):d},t.shape=function(e,r){return arguments.length?(O=e,P=r,t):O},t.rotateCenter=function(e){return arguments.length?(I=e,t):I},t.x=function(e){return arguments.length?(w="function"==typeof e?e:+e,t):w},t.y=function(e){return arguments.length?(E="function"==typeof e?e:+e,t):E},t.z=function(e){return arguments.length?(M="function"==typeof e?e:+e,t):M},t.sort=function(t,e){var r=t.centroid.z,o=e.centroid.z;return r<o?-1:r>o?1:r>=o?0:NaN},t.draw=function(t){if("POINT"!==O&&"LINE"!==O)return C[O](t)},t},Object.defineProperty(t,"__esModule",{value:!0})});