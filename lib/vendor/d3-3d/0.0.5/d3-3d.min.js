!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.d3=t.d3||{})}(this,function(t){"use strict";function e(t){var e=t.slice(0),r=0;e.push(e[0]);for(var o=0;o<=t.length-1;o++){var n=o+1,c=e[o].rotated,a=e[n].rotated;r+=(a.x-c.x)*(a.y+c.y)}return r>0}function r(t){for(var e=0,r=0,o=0,n=t.length,c=n-1;c>=0;c--)e+=t[c].rotated.x,r+=t[c].rotated.y,o+=t[c].rotated.z;return{x:e/n,y:r/n,z:o/n}}function o(t,e){var r=e.rotateCenter;t.x-=r[0],t.y-=r[1],t.z-=r[2];var o=n(c(a(t,e.z),e.y),e.x);return o.x+=r[0],o.y+=r[1],o.z+=r[2],o}function n(t,e){var r=Math.sin(e),o=Math.cos(e);return{x:t.x,y:t.y*o-t.z*r,z:t.y*r+t.z*o}}function c(t,e){var r=Math.sin(e),o=Math.cos(e);return{x:t.z*r+t.x*o,y:t.y,z:t.z*o-t.x*r}}function a(t,e){var r=Math.sin(e),o=Math.cos(e);return{x:t.x*o-t.y*r,y:t.y*r+t.y*o,z:t.z}}function d(t,e,r,n){for(var c=t.length-1;c>=0;c--){var a=t[c];a.rotated=o({x:r.x(a),y:r.y(a),z:r.z(a)},n),a.centroid=a.rotated,a.projected=e.project(a.rotated,e)}return t}function u(t,o,n,c){for(var a=[],u=t.length-1;u>=0;u--){var i=t[u],f=d([i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]],o,n,c),y=f[0],p=f[1],x=f[2],j=f[3],z=f[4],h=f[5],l=f[6],v=f[7],g=[y,p,x,j],s=[v,l,h,z],L=[z,h,p,y],N=[j,x,l,v],I=[z,y,j,v],w=[p,h,l,x];g.centroid=r(g),s.centroid=r(s),L.centroid=r(L),N.centroid=r(N),w.centroid=r(w),I.centroid=r(I),g.ccw=e(g),s.ccw=e(s),L.ccw=e(L),N.ccw=e(N),w.ccw=e(w),I.ccw=e(I),g.face="front",s.face="back",L.face="left",N.face="right",w.face="top",I.face="bottom";var E=[g,s,L,N,w,I];a.push(E)}return a}function i(t,o,n,c){for(var a=d(t,o,n,c),u=0,i=[],f=o.row,y=a.length/f,p=y-1;p>0;p--)for(var x=f-1;x>0;x--){var j=x+p*y,z=j-1,h=z-y+1,l=h-1,v=[a[j],a[h],a[l],a[z]];v.id="plane_"+u++,v.ccw=e(v),v.centroid=r(v),i.push(v)}return i}function f(t,e,n,c){for(var a=t.length-1;a>=0;a--){for(var d=t[a],u=d.length/2,i=parseInt(u),f=d.length-1;f>=0;f--){var y=d[f];y.rotated=o({x:n.x(y),y:n.y(y),z:n.z(y)},c),y.projected=e.project(y.rotated,e)}d.centroid=i===u?r([d[u-1],d[u]]):{x:d[i].rotated.x,y:d[i].rotated.y,z:d[i].rotated.z}}return t}function y(t,e,n,c){for(var a=t.length-1;a>=0;a--){var d=t[a],u=d[0],i=d[1];u.rotated=o({x:n.x(u),y:n.y(u),z:n.z(u)},c),i.rotated=o({x:n.x(i),y:n.y(i),z:n.z(i)},c),u.projected=e.project(u.rotated,e),i.projected=e.project(i.rotated,e),d.centroid=r(d)}return t}function p(t,n,c,a){for(var d=t.length-1;d>=0;d--){var u=t[d],i=u[0],f=u[1],y=u[2],p=u[3];i.rotated=o({x:c.x(i),y:c.y(i),z:c.z(i)},a),f.rotated=o({x:c.x(f),y:c.y(f),z:c.z(f)},a),y.rotated=o({x:c.x(y),y:c.y(y),z:c.z(y)},a),p.rotated=o({x:c.x(p),y:c.y(p),z:c.z(p)},a),i.projected=n.project(i.rotated,n),f.projected=n.project(f.rotated,n),y.projected=n.project(y.rotated,n),p.projected=n.project(p.rotated,n),u.ccw=e(u),u.centroid=r(u)}return t}function x(t,n,c,a){for(var d=t.length-1;d>=0;d--){for(var u=t[d],i=u.length-1;i>=0;i--){var f=u[i];f.rotated=o({x:c.x(f),y:c.y(f),z:c.z(f)},a),f.projected=n.project(f.rotated,n)}u.ccw=e(u),u.centroid=r(u)}return t}function j(t,n,c,a){for(var d=t.length-1;d>=0;d--){var u=t[d],i=u[0],f=u[1],y=u[2];i.rotated=o({x:c.x(i),y:c.y(i),z:c.z(i)},a),f.rotated=o({x:c.x(f),y:c.y(f),z:c.z(f)},a),y.rotated=o({x:c.x(y),y:c.y(y),z:c.z(y)},a),i.projected=n.project(i.rotated,n),f.projected=n.project(f.rotated,n),y.projected=n.project(y.rotated,n),u.ccw=e(u),u.centroid=r(u)}return t}function z(t){for(var e=t[t.length-1],r="M"+e.projected.x+","+e.projected.y,o=t.length-2;o>=0;o--){var n=t[o].projected;r+="L"+n.x+","+n.y}return r}function h(t){return"M"+t[0].projected.x+","+t[0].projected.y+"L"+t[1].projected.x+","+t[1].projected.y+"L"+t[2].projected.x+","+t[2].projected.y+"L"+t[3].projected.x+","+t[3].projected.y+"Z"}function l(t){for(var e=t[t.length-1],r="M"+e.projected.x+","+e.projected.y,o=t.length-2;o>=0;o--){var n=t[o].projected;r+="L"+n.x+","+n.y}return r+="Z"}function v(t){return"M"+t[0].projected.x+","+t[0].projected.y+"L"+t[1].projected.x+","+t[1].projected.y+"L"+t[2].projected.x+","+t[2].projected.y+"Z"}function g(t,e){return{x:e.origin[0]+e.scale*t.x,y:e.origin[1]+e.scale*t.y}}function s(t){return t[0]}function L(t){return t[1]}function N(t){return t[2]}t._3d=function(){function t(t){return R[O](t,{scale:r,origin:e,project:o,row:P},{x:w,y:E,z:M},{x:n,y:c,z:a,rotateCenter:I})}var e=[0,0],r=1,o=g,n=0,c=0,a=0,I=[0,0,0],w=s,E=L,M=N,P=void 0,O="POINT",R={CUBE:u,GRID:i,LINE:y,LINE_STRIP:f,PLANE:p,POINT:d,POLYGON:x,SURFACE:i,TRIANGLE:j},C={CUBE:h,GRID:h,LINE_STRIP:z,PLANE:h,POLYGON:l,SURFACE:h,TRIANGLE:v};return t.origin=function(r){return arguments.length?(e=r,t):e},t.scale=function(e){return arguments.length?(r=e,t):r},t.rotateX=function(e){return arguments.length?(n=e,t):n},t.rotateY=function(e){return arguments.length?(c=e,t):c},t.rotateZ=function(e){return arguments.length?(a=e,t):a},t.shape=function(e,r){return arguments.length?(O=e,P=r,t):O},t.rotateCenter=function(e){return arguments.length?(I=e,t):I},t.x=function(e){return arguments.length?(w="function"==typeof e?e:+e,t):w},t.y=function(e){return arguments.length?(E="function"==typeof e?e:+e,t):E},t.z=function(e){return arguments.length?(M="function"==typeof e?e:+e,t):M},t.sort=function(t,e){var r=t.centroid.z,o=e.centroid.z;return r<o?-1:r>o?1:r>=o?0:NaN},t.draw=function(t){if("POINT"!==O&&"LINE"!==O)return C[O](t)},t},Object.defineProperty(t,"__esModule",{value:!0})});