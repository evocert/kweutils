!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexroundrectangle=e()}(this,function(){"use strict";function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function t(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function e(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=o(r);if(n){var i=o(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return a(this,t)}}function y(t,e,i){var r=i.length;if(2<=r){var n=i[r-2],o=i[r-1];if(t===n&&e===o)return i}return i.push(t,e),i}function s(t,e,i,r,n,o,a,s,u){var h,l,c;a&&(o+=360),n=v(n);for(var f=((o=v(o))-n)/s,d=0;d<=s;d++)c=n+f*d,h=t+i*Math.cos(c),l=e+r*Math.sin(c),y(h,l,u);return u}function n(t,e,i,r){i.addToRenderList(e);var n=t.pipelines.set(this.pipeline),o=R(e,i,r),a=n.calcMatrix.copyFrom(o.calc),s=e._displayOriginX,u=e._displayOriginY,h=i.alpha*e.alpha;e.isFilled&&c(n,a,e,h,s,u),e.isStroked&&w(n,e,h,s,u)}var u=Phaser.Utils.Objects.GetValue,g=function(){function o(t,e,i,r,n){p(this,o),this.cornerRadius={},this._width=0,this._height=0,this.setTo(t,e,i,r,n)}return t(o,[{key:"setTo",value:function(t,e,i,r,n){return this.setPosition(t,e),this.setRadius(n),this.setSize(i,r),this}},{key:"setPosition",value:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}},{key:"setRadius",value:function(t){var e,i;void 0===t&&(t=0),i="number"==typeof t?e=t:(e=u(t,"x",0),u(t,"y",0));var r=this.cornerRadius;return r.tl=h(u(t,"tl",void 0),e,i),r.tr=h(u(t,"tr",void 0),e,i),r.bl=h(u(t,"bl",void 0),e,i),r.br=h(u(t,"br",void 0),e,i),this}},{key:"setSize",value:function(t,e){return this.width=t,this.height=e,this}},{key:"minWidth",get:function(){var t=this.cornerRadius;return Math.max(t.tl.x+t.tr.x,t.bl.x+t.br.x)}},{key:"minHeight",get:function(){var t=this.cornerRadius;return Math.max(t.tl.y+t.bl.y,t.tr.y+t.br.y)}},{key:"width",get:function(){return this._width},set:function(t){null==t&&(t=0),this._width=Math.max(t,this.minWidth)}},{key:"height",get:function(){return this._height},set:function(t){null==t&&(t=0),this._height=Math.max(t,this.minHeight)}},{key:"radius",get:function(){var t=this.cornerRadius;return Math.max(t.tl.x,t.tl.y,t.tr.x,t.tr.y,t.bl.x,t.bl.y,t.br.x,t.br.y)}}]),o}(),h=function(t,e,i){return void 0===t?{x:e,y:i}:"number"==typeof t?{x:t,y:t}:t},l=Math.PI/180,v=function(t){return t*l},O=Phaser.Renderer.WebGL.Utils,c=function(t,e,i,r,n,o){for(var a=O.getTintAppendFloatAlpha(i.fillColor,i.fillAlpha*r),s=i.pathData,u=i.pathIndexes,h=0;h<u.length;h+=3){var l=2*u[h],c=2*u[h+1],f=2*u[h+2],d=s[0+l]-n,p=s[1+l]-o,y=s[0+c]-n,g=s[1+c]-o,v=s[0+f]-n,b=s[1+f]-o,m=e.getX(d,p),x=e.getY(d,p),R=e.getX(y,g),k=e.getY(y,g),w=e.getX(v,b),P=e.getY(v,b);t.batchTri(m,x,R,k,w,P,a,a,a)}},f=Phaser.GameObjects.Components.TransformMatrix,d=new f,b=new f,m=new f,x={camera:d,sprite:b,calc:m},R=function(t,e,i){var r=d,n=b,o=m;return n.applyITRS(t.x,t.y,t.rotation,t.scaleX,t.scaleY),r.copyFrom(e.matrix),i?(r.multiplyWithOffset(i,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),n.e=t.x,n.f=t.y):(n.e-=e.scrollX*t.scrollFactorX,n.f-=e.scrollY*t.scrollFactorY),r.multiply(n,o),x},k=Phaser.Renderer.WebGL.Utils,w=function(t,e,i,r,n){var o=t.strokeTint,a=k.getTintAppendFloatAlpha(e.strokeColor,e.strokeAlpha*i);o.TL=a,o.TR=a,o.BL=a,o.BR=a;var s=e.pathData,u=s.length-1,h=e.lineWidth,l=h/2,c=s[0]-r,f=s[1]-n;e.closePath||(u-=2);for(var d=2;d<u;d+=2){var p=s[d]-r,y=s[d+1]-n;t.batchLine(c,f,p,y,l,l,h,d-2,!!e.closePath&&d===u-1),c=p,f=y}},P=function(t,e,i,r){var n=i||e.fillColor,o=r||e.fillAlpha,a=(16711680&n)>>>16,s=(65280&n)>>>8,u=255&n;t.fillStyle="rgba("+a+","+s+","+u+","+o+")"},_=function(t,e,i,r){var n=i||e.strokeColor,o=r||e.strokeAlpha,a=(16711680&n)>>>16,s=(65280&n)>>>8,u=255&n;t.strokeStyle="rgba("+a+","+s+","+u+","+o+")",t.lineWidth=e.lineWidth},T=Phaser.Renderer.Canvas.SetTransform,D={renderWebGL:n,renderCanvas:function(t,e,i,r){i.addToRenderList(e);var n=t.currentContext;if(T(t,n,e,i,r)){var o=e._displayOriginX,a=e._displayOriginY,s=e.pathData,u=s.length-1,h=s[0]-o,l=s[1]-a;n.beginPath(),n.moveTo(h,l),e.closePath||(u-=2);for(var c=2;c<u;c+=2){var f=s[c]-o,d=s[c+1]-a;n.lineTo(f,d)}n.closePath(),e.isFilled&&(P(n,e),n.fill()),e.isStroked&&(_(n,e),n.stroke()),n.restore()}}},j=Phaser.Utils.Objects.GetValue,S=Phaser.Geom.Polygon.Earcut,A=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(d,Phaser.GameObjects.Shape);var f=e(d);function d(t,e,i,r,n,o,a,s){var u;p(this,d),void 0===e&&(e=0),void 0===i&&(i=0);var h=new g;u=f.call(this,t,"RoundRectangle",h);var l=j(o,"radius",o);h.setTo(0,0,r,n,l);var c=j(o,"iteration",void 0);return u.setIteration(c),u.setPosition(e,i),void 0!==a&&u.setFillStyle(a,s),u.updateDisplayOrigin(),u.updateData(),u}return t(d,[{key:"updateData",value:function(){var t=this.geom,e=this.pathData;e.length=0;var i,r=t.cornerRadius,n=this.iteration+1;if(i=r.br,F(i)){var o=t.width-i.x,a=t.height-i.y;s(o,a,i.x,i.y,0,90,!1,n,e)}else y(t.width,t.height,e);if(i=r.bl,F(i)){o=i.x,a=t.height-i.y;s(o,a,i.x,i.y,90,180,!1,n,e)}else y(0,t.height,e);if(i=r.tl,F(i)){o=i.x,a=i.y;s(o,a,i.x,i.y,180,270,!1,n,e)}else y(0,0,e);if(i=r.tr,F(i)){o=t.width-i.x,a=i.y;s(o,a,i.x,i.y,270,360,!1,n,e)}else y(t.width,0,e);return e.push(e[0],e[1]),this.pathIndexes=S(e),this}},{key:"resize",value:function(t,e){if(void 0===e&&(e=t),this.geom.width===t&&this.geom.height===e)return this;this.geom.height=e,this.geom.width=t,this.updateDisplayOrigin(),this.updateData();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this}},{key:"setIteration",value:function(t){return void 0===t&&(t=6),this.iteration=t,this}},{key:"setRadius",value:function(t){return void 0===t&&(t=0),this.radius=t,this}},{key:"setCornerRadius",value:function(t){return this.setRadius(t)}},{key:"width",get:function(){return this.geom.width},set:function(t){this.resize(t,this.height)}},{key:"height",get:function(){return this.geom.height},set:function(t){this.resize(this.width,t)}},{key:"iteration",get:function(){return this._iteration},set:function(t){void 0!==this._iteration?this._iteration!==t&&(this._iteration=t,this.updateData()):this._iteration=t}},{key:"radius",get:function(){return this.geom.radius},set:function(t){this.geom.setRadius(t),this.updateDisplayOrigin(),this.updateData()}},{key:"cornerRadius",get:function(){return this.geom.cornerRadius},set:function(t){this.radius=t}}]),d}(),F=function(t){return 0!==t.x&&0!==t.y};return Object.assign(A.prototype,D),A});
